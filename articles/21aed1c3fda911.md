---
title: "Github Actions å®Ÿè¡Œæ™‚ã« 'iam.serviceaccounts.actAs'æ¨©é™ãŒä¸è¶³ã—ã¦ã„ã‚‹ã‚¨ãƒ©ãƒ¼ã®è§£æ±ºæ–¹æ³•"
emoji: "ğŸ˜½"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [github,firebase,gcp,nextjs,typescript]
published: false
---

## Github Actions å®Ÿè¡Œæ™‚ã®ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°

```
"Caller is missing permission 'iam.serviceaccounts.actAs' on service account projects/-/serviceAccounts/{{ XXXXX }}-compute@developer.
gserviceaccount.com.Grant the role 'roles/iam.serviceAccountUser' to the caller on the service account projects/-/serviceAccounts/
{{ XXXXX }}-compute@developer.gserviceaccount.com.You can do that by running 'gcloud iam service-accounts add-iam-policy-binding projects/-/
serviceAccounts/{{ XXXXX }}-compute@developer.gserviceaccount.com --member MEMBER --role roles/iam.serviceAccountUser'where MEMBER has a prefix 
like 'user:' or 'serviceAccount:'.Details and instructions for the Cloud Console can be found at https://cloud.google.com/functions/docs/reference/
iam/roles#additional-configuration.",
```

ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ã€Google Cloud Platform (GCP) ã®IAM (Identity and Access Management)ã«é–¢é€£ã™ã‚‹æ¨©é™ã®å•é¡Œã‚’æŒ‡ã—ã¦ã„ã¾ã™ã€‚
å…·ä½“çš„ã«ã¯ã€ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ {{ XXXXX }}-compute@developer.gserviceaccount.com ã«å¯¾ã—ã¦ã€iam.serviceaccounts.actAs æ¨©é™ãŒä¸è¶³ã—ã¦ã„ã‚‹ã¨è¨€ã£ã¦ã„ã¾ã™ã€‚


ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ã¯ã€æ¨©é™ã‚’è¿½åŠ ã™ã‚‹ãŸã‚ã®å…·ä½“çš„ãªã‚³ãƒãƒ³ãƒ‰ãŒç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚
â€»ãŸã ã—ã€ã“ã®ã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œã«ã¯ MEMBER ã®å€¤ãŒå¿…è¦ã§ã™ã€‚MEMBER ã¯ 'user:' ã¾ãŸã¯ 'serviceAccount:' ã®ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã‚’æŒã¤å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

```sql
gcloud iam service-accounts add-iam-policy-binding projects/-/serviceAccounts/{{ XXXXX }}-compute@developer.gserviceaccount.com --member MEMBER --role roles/iam.serviceAccountUser
```

## å…·ä½“çš„ãªå¯¾å‡¦æ–¹æ³•

**Github Actions ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã€{{ XXXXX }}-compute@developer.gserviceaccount.com ã«æ¨©é™ã‚’ä»˜ä¸ã—ã¦ã‚‚è§£æ±ºã§ãã¾ã›ã‚“ã€‚å®Ÿè¡Œã—ã¦ã„ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«IAMã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚**

ç§ã®å ´åˆã€github-action@{{ XXXXX }}.iam.gserviceaccount.com ã¨ã„ã†ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§Github Actionsã‚’å®Ÿè¡Œã—ã¦ã„ã‚‹ãŸã‚ã€ã“ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«IAMã‚’è¨­å®šã™ã‚‹ã“ã¨ã§è§£æ±ºã§ãã¾ã—ãŸã€‚

**å…·ä½“çš„ãªã‚³ãƒãƒ³ãƒ‰**

```
gcloud iam service-accounts add-iam-policy-binding projects/-/serviceAccounts/{{ XXXXX }}-compute@developer.gserviceaccount.com --member serviceAccount:github-action@{{ XXXXX }}.iam.gserviceaccount.com --role roles/iam.serviceAccountUser
```

